# å›¾è¡¨æ— æ•°æ®é—®é¢˜ä¿®å¤

## ğŸ› é—®é¢˜æè¿°

ç”¨æˆ·åé¦ˆå›¾è¡¨æ²¡æœ‰æ•°æ®æ˜¾ç¤ºï¼Œç»è¿‡åˆ†æå‘ç°æ˜¯Xè½´åæ ‡å€¼è®¡ç®—å’Œæ•°æ®è®¾ç½®çš„é—®é¢˜ã€‚

## ğŸ” é—®é¢˜åˆ†æ

### 1. Xè½´åæ ‡å€¼è®¡ç®—é”™è¯¯

**é—®é¢˜**ï¼š`KLineData.getXValue()`æ–¹æ³•ä½¿ç”¨åŸºäº2024å¹´1æœˆ1æ—¥çš„å¤æ‚æ—¥æœŸè®¡ç®—

```java
// åŸæ¥çš„é”™è¯¯å®ç°
public float getXValue() {
    if (date == null) return 0;
    long baseTime = 1704067200000L; // 2024-01-01 00:00:00 UTC
    long daysSinceBase = (date.getTime() - baseTime) / (24 * 60 * 60 * 1000);
    return (float) daysSinceBase;
}
```

**é—®é¢˜å½±å“**ï¼š

- Xè½´å€¼éå¸¸å¤§ï¼Œè¶…å‡ºå›¾è¡¨æ˜¾ç¤ºèŒƒå›´
- ä¸æ•°ç»„ç´¢å¼•ä¸åŒ¹é…ï¼Œå¯¼è‡´ValueFormatteræ— æ³•æ­£ç¡®å·¥ä½œ
- å›¾è¡¨æ— æ³•æ­£ç¡®æ˜¾ç¤ºKçº¿æ•°æ®

### 2. ValueFormatterä¾èµ–é—®é¢˜

**é—®é¢˜**ï¼šXè½´çš„ValueFormatteråœ¨å›¾è¡¨åˆå§‹åŒ–æ—¶å°±è¢«è®¾ç½®ï¼Œä½†æ­¤æ—¶klineDataListè¿˜æœªåˆå§‹åŒ–

## ğŸ”§ ä¿®å¤æ–¹æ¡ˆ

### 1. ç®€åŒ–Xè½´åæ ‡å€¼è®¡ç®—

```java
// ä¿®å¤åçš„å®ç°
private int index = 0; // æ·»åŠ ç´¢å¼•å­—æ®µ

public float getXValue() {
    return (float) index;
}

public void setIndex(int index) {
    this.index = index;
}
```

### 2. åœ¨æ•°æ®ç”Ÿæˆæ—¶è®¾ç½®ç´¢å¼•

```java
for(int i = 0;i< 100;i++){
// ... æ•°æ®ç”Ÿæˆé€»è¾‘

KLineData klineData = new KLineData(date, open, high, low, close, volume);
    klineData.setIndex(i); // è®¾ç½®ç´¢å¼•
    dataList.add(klineData);
}
```

### 3. æ”¹è¿›ValueFormatterçš„ç©ºå€¼å¤„ç†

```java
xAxis.setValueFormatter(new ValueFormatter() {
    @Override
    public String getFormattedValue ( float value){
        // å…ˆæ£€æŸ¥klineDataListæ˜¯å¦å·²åˆå§‹åŒ–
        if (klineDataList == null || klineDataList.isEmpty()) {
            return "";
        }

        int index = (int) value;
        if (index >= 0 && index < klineDataList.size()) {
            return dateFormat.format(klineDataList.get(index).getDate());
        }
        return "";
    }
});
```

### 4. ç§»é™¤è¿‡åº¦é™åˆ¶çš„è½´èŒƒå›´è®¾ç½®

```java
// ç§»é™¤äº†ç²¾ç¡®çš„è½´èŒƒå›´è®¾ç½®ï¼Œè®©å›¾è¡¨è‡ªåŠ¨è®¡ç®—
// è¿™æ ·å¯ä»¥é¿å…å› èŒƒå›´è®¾ç½®é”™è¯¯å¯¼è‡´çš„æ˜¾ç¤ºé—®é¢˜
```

### 5. æ·»åŠ è°ƒè¯•ä¿¡æ¯

```java
// æ·»åŠ æ•°æ®ç”ŸæˆéªŒè¯
Toast.makeText(getContext(), "ç”Ÿæˆäº† "+klineDataList.size() +" æ¡Kçº¿æ•°æ®",Toast.LENGTH_SHORT).show();

// æ·»åŠ CandleEntryåˆ›å»ºéªŒè¯
Toast.makeText(getContext(), "åˆ›å»ºäº† "+candleEntries.size() +" ä¸ªCandleEntry",Toast.LENGTH_SHORT).show();
```

## âœ… ä¿®å¤æ•ˆæœ

### ä¿®å¤å‰

- å›¾è¡¨å®Œå…¨æ²¡æœ‰æ•°æ®æ˜¾ç¤º
- Xè½´æ ‡ç­¾æ— æ³•æ­£ç¡®æ˜¾ç¤º
- å¯èƒ½å‡ºç°åº”ç”¨å´©æºƒ

### ä¿®å¤å

- âœ… Kçº¿æ•°æ®æ­£å¸¸æ˜¾ç¤º
- âœ… Xè½´æ ‡ç­¾æ˜¾ç¤ºæ­£ç¡®çš„æ—¥æœŸæ ¼å¼
- âœ… å›¾è¡¨äº¤äº’åŠŸèƒ½æ­£å¸¸
- âœ… è°ƒè¯•ä¿¡æ¯å¸®åŠ©éªŒè¯æ•°æ®åŠ è½½

## ğŸ¯ æŠ€æœ¯è¦ç‚¹

1. **ç®€å•ç´¢å¼•**ï¼šä½¿ç”¨ç®€å•çš„æ•°ç»„ç´¢å¼•ä½œä¸ºXè½´åæ ‡ï¼Œé¿å…å¤æ‚çš„æ—¥æœŸè®¡ç®—
2. **ç©ºå€¼å®‰å…¨**ï¼šåœ¨ValueFormatterä¸­æ·»åŠ ç©ºå€¼æ£€æŸ¥ï¼Œé¿å…ç©ºæŒ‡é’ˆå¼‚å¸¸
3. **è‡ªåŠ¨èŒƒå›´**ï¼šè®©å›¾è¡¨åº“è‡ªåŠ¨è®¡ç®—åˆé€‚çš„æ˜¾ç¤ºèŒƒå›´ï¼Œè€Œä¸æ˜¯æ‰‹åŠ¨è®¾ç½®
4. **è°ƒè¯•å‹å¥½**ï¼šæ·»åŠ Toastæç¤ºï¼Œæ–¹ä¾¿é—®é¢˜æ’æŸ¥

## ğŸ“± éªŒè¯æ–¹æ³•

è¿è¡Œåº”ç”¨ååº”è¯¥çœ‹åˆ°ï¼š

1. "ç”Ÿæˆäº† 100 æ¡Kçº¿æ•°æ®" çš„æç¤º
2. "åˆ›å»ºäº† 100 ä¸ªCandleEntry" çš„æç¤º
3. "Kçº¿æ•°æ®åŠ è½½å®Œæˆ" çš„æç¤º
4. å›¾è¡¨æ˜¾ç¤º100å¤©çš„Kçº¿æ•°æ®
5. Xè½´æ˜¾ç¤ºyyyy-MM-ddæ ¼å¼çš„æ—¥æœŸæ ‡ç­¾

## ğŸ”„ åç»­ä¼˜åŒ–

1. **æ€§èƒ½ä¼˜åŒ–**ï¼šå¯¹äºå¤§é‡æ•°æ®ï¼Œå¯ä»¥è€ƒè™‘æ•°æ®é‡‡æ ·
2. **é”™è¯¯å¤„ç†**ï¼šæ·»åŠ æ›´å®Œå–„çš„é”™è¯¯å¤„ç†æœºåˆ¶
3. **ç”¨æˆ·ä½“éªŒ**ï¼šä¼˜åŒ–åŠ è½½è¿‡ç¨‹çš„ç”¨æˆ·åé¦ˆ

---

é€šè¿‡è¿™äº›ä¿®å¤ï¼Œå›¾è¡¨ç°åœ¨åº”è¯¥èƒ½å¤Ÿæ­£å¸¸æ˜¾ç¤ºKçº¿æ•°æ®å’Œæ—¥æœŸæ ‡ç­¾ã€‚ 